entity_type: Lab
schema_version: 2

default_locale: en

title:
  locales:
    en: Robust Lab Example
    es: Ejemplo de Robust Lab

description:
  locales:
    en: Seriously the best lab you've ever taken. Bar none.
    es: En serio, el mejor lab que has tomado. Sin excepción.

duration: 60
level: easy-peasy
tags:
  - sample
  - life-changing
  - gcp

instruction:
  type: html
  uri:
    locales:
      en: "./instructions/en.html"
      es: "./instructions/es.html"

resources:
  - type: file
    title:
      locales:
        en: Sample PDF
        es: Ejemplo de PDF
    description:
      locales:
        en: This PDF contains all of the code samples for the lab.
        es: Este PDF contiene todos los ejemplos de código para el laboratorio.
    uri:
      locales:
        en: "./resources/sample-en.pdf"
        es: "./resources/sample-es.pdf"
  - type: video
    id: intro-video
    title:
      locales:
        en: Welcome to GCP!
        es: ¡Bienvenido a GCP!
    uri:
      locales:
        en: https://www.youtu.be/oHg5SJYRHA0
        es: https://www.youtu.be/7jjoyy7_RCk
    description:
      locales:
        en: Overview of Google Cloud Platform
        es: Descripción general de Google Cloud Platform
    duration: 360

environment:
  student_visible_outputs:
    - label:
        locales:
          en: "GCP Project"
      reference: primary_project.project_id
    - label:
        locales:
          en: "Username"
      reference: primary_user.username
    - label:
        locales:
          en: "Password"
      reference: primary_user.password

  resources:
    - type: gcp_project
      id: primary_project
      variant: gcpfree
      startup_script:
        type: deployment_manager
        path: dm_startup.zip
        custom_properties:
          - key: userNameWindows
            value: student
      cleanup_script:
        type: deployment_manager
        path: dm_cleanup.zip
        custom_properties:
          - key: primary_project_zone
            reference: primary_project.default_zone
    - type: gcp_user
      id: primary_user
      permissions:
      - project: primary_project
        roles:
        - roles/editor
        - roles/appengine.appAdmin
        - roles/bigquery.admin
        - roles/bigquery.user

assessment:
  passing_percentage: 75.0
  steps:
  - title:
      locales:
        en: Create a Cloud Storage bucket
        es: Crear un depósito de almacenamiento en la nube
    maximum_score: 5
    student_messages:
      success:
        locales:
          en:
            Great job! You created the bucket!
          es:
            ¡Gran trabajo! ¡Creaste el cubo!
      bucket_missing:
        locales:
          en:
            Oops! No bucket found.
          es:
            ¡Uy! No se ha encontrado el cubo.
      bucket_misconfigured:
        locales:
          en:
            Hmm. The bucket is there, but it is misconfigured.
          es:
            Hmm. El cubo está allí, pero está mal configurado.
    services:
    - primary_project.StorageV1
    code: |-
      def check(handles: handles, resources: resources, maximum_score: maximum_score)
        storage_handle = handles['primary_project.StorageV1']

        # Check for bucket
        found_bucket = ...
        unless found_bucket
          return { score: 0, student_message: 'bucket_missing' }
        end

        # Check bucket configuration
        bucket_configured_correctly = ...
        unless bucket_configured_correctly
          return { score: 2, student_message: 'bucket_misconfigured' }
        end

        { score: maximum_score, student_message: 'success' }
      end
